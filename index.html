<!doctype html>
<html lang="id">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Game Edukasi Informatika SMP</title>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            box-sizing: border-box;
        }

        html, body {
            height: 100%;
            width: 100%;
        }

        body {
            font-family: 'Poppins', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #2d3748;
            overflow-x: hidden;
        }

        .app-container {
            width: 100%;
            min-height: 100%;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            animation: fadeInDown 0.6s ease-out;
        }

        .header h1 {
            color: #ffffff;
            font-size: 2.5rem;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
            margin-bottom: 10px;
        }

        .header p {
            color: #e2e8f0;
            font-size: 1.1rem;
        }

        .card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
            max-width: 800px;
            width: 100%;
            animation: fadeInUp 0.6s ease-out;
        }

        .menu-utama {
            text-align: center;
        }

        .btn {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 30px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            color: #2d3748;
        }

        .quiz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .stats {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .stat-item {
            background: #f7fafc;
            padding: 10px 20px;
            border-radius: 10px;
            font-weight: 600;
        }

        .progress-container {
            background: #e2e8f0;
            height: 8px;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 30px;
        }

        .progress-bar {
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            height: 100%;
            transition: width 0.3s ease;
        }

        .question-card {
            background: #f7fafc;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
        }

        .question-text {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 20px;
            color: #2d3748;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .option-btn {
            background: white;
            color: #2d3748;
            padding: 18px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 1rem;
            text-align: left;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .option-btn:hover {
            background: #edf2f7;
            border-color: #667eea;
            transform: translateX(5px);
        }

        .option-btn.correct {
            background: #c6f6d5;
            border-color: #48bb78;
        }

        .option-btn.wrong {
            background: #fed7d7;
            border-color: #f56565;
        }

        .option-btn:disabled {
            cursor: not-allowed;
        }

        .explanation {
            background: #e6fffa;
            padding: 20px;
            border-radius: 12px;
            margin-top: 20px;
            border-left: 4px solid #38b2ac;
        }

        .explanation h4 {
            color: #2c7a7b;
            margin-bottom: 10px;
        }

        .result-card {
            text-align: center;
        }

        .result-score {
            font-size: 4rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 20px 0;
        }

        .badges {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .badge {
            background: linear-gradient(135deg, #ffd89b 0%, #19547b 100%);
            color: white;
            padding: 15px 25px;
            border-radius: 50px;
            font-weight: 600;
            font-size: 1.1rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .leaderboard-list {
            margin: 20px 0;
        }

        .leaderboard-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: #f7fafc;
            border-radius: 10px;
            margin-bottom: 10px;
        }

        .leaderboard-rank {
            font-size: 1.5rem;
            font-weight: 700;
            color: #667eea;
            width: 50px;
        }

        .leaderboard-info {
            flex: 1;
            padding: 0 15px;
        }

        .leaderboard-score {
            font-size: 1.2rem;
            font-weight: 700;
            color: #2d3748;
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .hidden {
            display: none !important;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }

            .card {
                padding: 20px;
            }

            .question-text {
                font-size: 1.1rem;
            }

            .result-score {
                font-size: 3rem;
            }

            .quiz-header {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="app-container">
   <div class="header">
    <h1 id="gameTitle">üíª Quiz Informatika SMP</h1>
    <p id="welcomeMessage">Asah Pengetahuan Informatikamu dengan Cara yang Menyenangkan!</p>
    <p id="welcomeMessage">Quiz ini dibuat oleh Canva AI, Dikembangkan oleh Ananda Dwi Laras, S.Kom. </p>
   </div><!-- Menu Utama -->
   <div id="menuUtama" class="card menu-utama">
    <h2 style="margin-bottom: 20px; color: #2d3748;">Quiz Informatika</h2>
    <p style="text-align: center; color: #4a5568; margin-bottom: 30px; font-size: 1.1rem;">Pilih mode permainan yang kamu inginkan</p>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;">
     <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 25px; border-radius: 15px; color: white; text-align: center; cursor: pointer; transition: transform 0.3s ease;" onclick="startQuiz()">
      <div style="font-size: 3rem; margin-bottom: 10px;">
       üíª
      </div>
      <h3 style="margin-bottom: 10px; color: white;">Mode Solo</h3>
      <p style="font-size: 0.9rem; opacity: 0.9;">Bermain sendiri dan kumpulkan XP sebanyak-banyaknya</p>
     </div>
     <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); padding: 25px; border-radius: 15px; color: white; text-align: center; cursor: pointer; transition: transform 0.3s ease;" onclick="showBattleSetup()">
      <div style="font-size: 3rem; margin-bottom: 10px;">
       ‚öîÔ∏è
      </div>
      <h3 style="margin-bottom: 10px; color: white;">Mode Battle</h3>
      <p style="font-size: 0.9rem; opacity: 0.9;">Kompetisi antar tim, siapa yang paling cepat dan akurat!</p>
     </div>
    </div>
    <div style="margin-top: 30px; display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;"><button class="btn btn-secondary" onclick="showLeaderboard()" id="leaderboardBtn">üèÜ Leaderboard</button> <button class="btn" onclick="showAdminPanel()" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">üîß Panel Admin</button>
    </div>
   </div><!-- Quiz Section -->
   <div id="quizSection" class="card hidden">
    <div class="quiz-header"><button class="btn btn-secondary" onclick="backToMenu()" style="padding: 10px 20px; font-size: 0.9rem;">‚Üê Kembali</button>
     <div class="stats">
      <div class="stat-item">
       üéØ Skor: <span id="currentScore">0</span>
      </div>
      <div class="stat-item">
       ‚≠ê XP: <span id="currentXP">0</span>
      </div>
      <div class="stat-item">
       ‚ùì <span id="questionNumber">1</span>/<span id="totalQuestions">10</span>
      </div>
     </div>
    </div>
    <div class="progress-container">
     <div class="progress-bar" id="progressBar" style="width: 0%"></div>
    </div>
    <div class="question-card">
     <div class="question-text" id="questionText">
      Loading...
     </div>
     <div class="options" id="optionsContainer"></div>
     <div id="explanationBox" class="explanation hidden">
      <h4>üí° Penjelasan:</h4>
      <p id="explanationText"></p>
     </div>
    </div><button class="btn" id="nextBtn" onclick="nextQuestion()" style="display: none;">Lanjut ‚Üí</button>
   </div><!-- Result Section -->
   <div id="resultSection" class="card hidden result-card">
    <h2 style="color: #2d3748; margin-bottom: 20px;">üéâ Selamat!</h2>
    <div class="result-score" id="finalScore">
     0
    </div>
    <p style="font-size: 1.2rem; color: #4a5568; margin-bottom: 10px;">Total XP: <strong id="finalXP">0</strong></p>
    <p style="font-size: 1rem; color: #718096;">Benar: <span id="correctAnswers">0</span> | Salah: <span id="wrongAnswers">0</span></p>
    <div class="badges" id="badgesContainer"></div>
    <div style="margin-top: 30px;"><button class="btn" onclick="backToMenu()">üè† Menu Utama</button> <button class="btn btn-secondary" onclick="retryQuiz()">üîÑ Coba Lagi</button>
    </div>
   </div><!-- Leaderboard Section -->
   <div id="leaderboardSection" class="card hidden">
    <h2 style="color: #2d3748; margin-bottom: 20px; text-align: center;">üèÜ Leaderboard</h2>
    <div class="leaderboard-list" id="leaderboardList"></div>
    <div style="text-align: center; margin-top: 20px;"><button class="btn" onclick="backToMenu()">‚Üê Kembali</button>
    </div>
   </div><!-- Battle Setup Section -->
   <div id="battleSetup" class="card hidden">
    <h2 style="color: #2d3748; margin-bottom: 20px; text-align: center;">‚öîÔ∏è Setup Battle Quiz</h2>
    <div style="background: #f7fafc; padding: 25px; border-radius: 12px; margin-bottom: 20px;">
     <h3 style="color: #2d3748; margin-bottom: 20px;">Daftarkan Tim</h3>
     <div id="teamsList" style="margin-bottom: 20px;"></div>
     <div style="display: flex; gap: 10px; margin-bottom: 15px;"><input type="text" id="teamNameInput" placeholder="Nama Tim (contoh: Tim Merah)" style="flex: 1; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 1rem;"> <button class="btn" onclick="addTeam()" style="padding: 12px 30px; margin: 0;">‚ûï Tambah</button>
     </div>
     <div style="background: #e6fffa; padding: 15px; border-radius: 8px; border-left: 4px solid #38b2ac;">
      <p style="color: #2c7a7b; margin: 0; font-size: 0.9rem;">üí° <strong>Minimal 2 tim</strong> untuk memulai battle!</p>
     </div>
    </div>
    <div style="background: #f7fafc; padding: 25px; border-radius: 12px; margin-bottom: 20px;">
     <h3 style="color: #2d3748; margin-bottom: 15px;">Pengaturan Battle</h3>
     <div style="margin-bottom: 15px;"><label style="display: block; margin-bottom: 8px; font-weight: 600; color: #4a5568;">Jumlah Soal per Tim:</label> <select id="battleQuestionCount" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 1rem;"> <option value="5">5 Soal</option> <option value="10" selected>10 Soal</option> <option value="15">15 Soal</option> </select>
     </div>
     <div style="margin-bottom: 15px;"><label style="display: block; margin-bottom: 8px; font-weight: 600; color: #4a5568;">Mode Battle:</label> <select id="battleMode" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 1rem;"> <option value="speed">‚ö° Speed Mode - Tim tercepat menang</option> <option value="accuracy">üéØ Accuracy Mode - Skor tertinggi menang</option> </select>
     </div>
    </div>
    <div style="text-align: center;"><button class="btn" onclick="startBattle()" id="startBattleBtn" style="font-size: 1.2rem; padding: 18px 40px; margin: 10px;">üöÄ Mulai Battle!</button> <button class="btn btn-secondary" onclick="backToMenu()" style="padding: 18px 40px; margin: 10px;">‚Üê Kembali</button>
    </div>
   </div><!-- Battle Quiz Section -->
   <div id="battleQuizSection" class="card hidden">
    <div class="quiz-header"><button class="btn btn-secondary" onclick="backToMenu()" style="padding: 10px 20px; font-size: 0.9rem;">‚Üê Keluar Battle</button>
     <div class="stat-item" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; font-size: 1.1rem; padding: 12px 24px;"><span id="currentTeamName">Tim 1</span>
     </div>
    </div>
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 15px;">
     <div class="stats">
      <div class="stat-item">
       üìä Skor: <span id="battleScore">0</span>
      </div>
      <div class="stat-item">
       ‚è±Ô∏è Total: <span id="battleTimer">0</span>s
      </div>
      <div class="stat-item">
       ‚ùì Soal: <span id="battleQuestionNumber">1</span>/<span id="battleTotalQuestions">10</span>
      </div>
     </div>
     <div class="stat-item" id="questionTimerDisplay" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; font-size: 1.3rem; font-weight: 700; padding: 15px 25px;">
      ‚è∞ <span id="questionTimerText">10</span>s
     </div>
    </div>
    <div class="progress-container">
     <div class="progress-bar" id="battleProgressBar" style="width: 0%"></div>
    </div>
    <div class="question-card">
     <div class="question-text" id="battleQuestionText">
      Loading...
     </div>
     <div class="options" id="battleOptionsContainer"></div>
     <div id="battleExplanationBox" class="explanation hidden">
      <h4>üí° Penjelasan:</h4>
      <p id="battleExplanationText"></p>
     </div>
    </div><button class="btn" id="battleNextBtn" onclick="nextBattleQuestion()" style="display: none;">Lanjut ‚Üí</button>
   </div><!-- Battle Result Section -->
   <div id="battleResultSection" class="card hidden">
    <h2 style="color: #2d3748; margin-bottom: 30px; text-align: center;">‚öîÔ∏è Hasil Battle Quiz</h2>
    <div id="battleResultsContainer" style="margin-bottom: 30px;"></div>
    <div id="winnerAnnouncement" style="text-align: center; margin: 40px 0;"></div>
    <div style="text-align: center; margin-top: 30px;"><button class="btn" onclick="backToMenu()">üè† Menu Utama</button> <button class="btn btn-secondary" onclick="showBattleSetup()">üîÑ Battle Lagi</button>
    </div>
   </div><!-- Admin Panel -->
   <div id="adminPanel" class="card hidden">
    <h2 style="color: #2d3748; margin-bottom: 20px; text-align: center;">üîß Panel Admin</h2>
    <div style="background: #f7fafc; padding: 20px; border-radius: 12px; margin-bottom: 20px;">
     <h3 style="color: #2d3748; margin-bottom: 15px; font-size: 1.2rem;">üì§ Import Soal Informatika Massal</h3>
     <div style="margin-bottom: 20px;"><label style="display: block; margin-bottom: 10px; font-weight: 600; color: #4a5568;">Paste Soal dengan Format Khusus:</label> <textarea id="bulkQuestionsInput" placeholder="Paste soal dengan format yang benar di sini..." style="width: 100%; min-height: 200px; padding: 15px; border: 2px solid #e2e8f0; border-radius: 8px; font-family: monospace; font-size: 0.9rem; resize: vertical;"></textarea>
     </div><button class="btn" onclick="importBulkQuestions()" style="width: 100%; margin: 0;">üì• Import Semua Soal</button>
     <div id="uploadStatus" style="margin-top: 15px; padding: 15px; border-radius: 8px; display: none;"></div>
    </div>
    <div style="background: #e6fffa; padding: 20px; border-radius: 12px; border-left: 4px solid #38b2ac; margin-bottom: 20px;">
     <h4 style="color: #2c7a7b; margin-bottom: 10px;">üìù Format Import yang Benar:</h4>
     <p style="color: #2d3748; margin-bottom: 10px; line-height: 1.6;">Setiap soal harus dipisahkan dengan garis pemisah (---) dan mengikuti format:</p>
     <pre style="background: white; padding: 15px; border-radius: 8px; overflow-x: auto; font-size: 0.9rem; color: #2d3748; border: 1px solid #cbd5e0;">Pertanyaan: Apa kepanjangan dari CPU?
A. Central Processing Unit
B. Computer Personal Unit
C. Central Program Unit
D. Computer Processing Unit
Jawaban: A
Penjelasan: CPU adalah Central Processing Unit, yaitu otak dari komputer.
Tingkat: mudah
---
Pertanyaan: Apa fungsi dari RAM?
A. Menyimpan data permanen
B. Menyimpan data sementara
C. Menampilkan gambar
D. Mengatur suhu
Jawaban: B
Penjelasan: RAM menyimpan data sementara saat komputer berjalan.
Tingkat: sedang
---</pre>
    </div>
    <div style="background: #fff5f5; padding: 20px; border-radius: 12px; border-left: 4px solid #f56565; margin-bottom: 20px;">
     <h4 style="color: #c53030; margin-bottom: 10px;">‚ö†Ô∏è Catatan Penting:</h4>
     <ul style="color: #2d3748; line-height: 1.8; padding-left: 20px;">
      <li>Tingkat kesulitan hanya: <strong>mudah</strong> atau <strong>sedang</strong></li>
      <li>Jawaban harus menggunakan huruf kapital: A, B, C, atau D</li>
      <li>Setiap soal harus dipisahkan dengan garis "---"</li>
      <li>Soal yang berhasil diimport akan langsung tersimpan di localStorage</li>
      <li>Copy-paste format dari Word/Google Docs/Notepad langsung bisa digunakan!</li>
     </ul>
    </div>
    <div style="background: #f7fafc; padding: 20px; border-radius: 12px; margin-bottom: 20px;">
     <h3 style="color: #2d3748; margin-bottom: 15px; font-size: 1.2rem;">üìä Kelola Soal Informatika</h3><button class="btn btn-secondary" onclick="viewQuestions()" style="width: 100%; margin: 0;">üíª Lihat Semua Soal</button>
     <div id="questionsList" style="margin-top: 20px;"></div>
    </div>
    <div style="text-align: center; margin-top: 20px;"><button class="btn" onclick="backToMenu()">‚Üê Kembali ke Menu</button> <button class="btn" onclick="resetAllQuestions()" style="background: linear-gradient(135deg, #fc466b 0%, #3f5efb 100%);">üóëÔ∏è Reset Semua Soal</button>
    </div>
   </div>
  </div>
  <script>
        // Data soal default
        let questionsData = [
            {
                question: "Apa kepanjangan dari CPU?",
                options: ["Central Processing Unit", "Computer Personal Unit", "Central Program Unit", "Computer Processing Unit"],
                answer: 0,
                explanation: "CPU adalah Central Processing Unit, yaitu otak dari komputer yang memproses semua instruksi.",
                difficulty: "mudah"
            },
            {
                question: "Perangkat lunak yang digunakan untuk membuat presentasi adalah?",
                options: ["Microsoft Word", "Microsoft Excel", "Microsoft PowerPoint", "Adobe Photoshop"],
                answer: 2,
                explanation: "Microsoft PowerPoint adalah aplikasi khusus untuk membuat presentasi dengan slide.",
                difficulty: "mudah"
            },
            {
                question: "Apa fungsi dari RAM pada komputer?",
                options: ["Menyimpan data permanen", "Menyimpan data sementara saat komputer berjalan", "Menampilkan gambar", "Mengatur suhu komputer"],
                answer: 1,
                explanation: "RAM (Random Access Memory) menyimpan data sementara yang sedang diproses oleh komputer.",
                difficulty: "sedang"
            },
            {
                question: "Apa yang dimaksud dengan algoritma?",
                options: ["Program komputer", "Langkah-langkah sistematis untuk menyelesaikan masalah", "Bahasa pemrograman", "Perangkat keras"],
                answer: 1,
                explanation: "Algoritma adalah urutan langkah-langkah logis dan sistematis untuk menyelesaikan suatu masalah.",
                difficulty: "sedang"
            },
            {
                question: "Ekstensi file untuk gambar JPEG adalah?",
                options: [".doc", ".jpg", ".txt", ".mp3"],
                answer: 1,
                explanation: "File gambar JPEG menggunakan ekstensi .jpg atau .jpeg.",
                difficulty: "mudah"
            },
            {
                question: "Apa fungsi dari sistem operasi pada komputer?",
                options: ["Menghubungkan ke internet", "Mengelola hardware dan software", "Membuat dokumen", "Memutar musik"],
                answer: 1,
                explanation: "Sistem operasi adalah software yang mengelola semua hardware dan software pada komputer.",
                difficulty: "sedang"
            },
            {
                question: "Browser web yang dikembangkan oleh Google adalah?",
                options: ["Firefox", "Safari", "Chrome", "Opera"],
                answer: 2,
                explanation: "Google Chrome adalah browser web yang dikembangkan oleh Google sejak tahun 2008.",
                difficulty: "mudah"
            },
            {
                question: "Bahasa pemrograman yang sering digunakan untuk membuat website adalah?",
                options: ["Python", "Java", "JavaScript", "C++"],
                answer: 2,
                explanation: "JavaScript adalah bahasa pemrograman yang paling banyak digunakan untuk membuat website interaktif.",
                difficulty: "sedang"
            },
            {
                question: "Apa kepanjangan dari HTML?",
                options: ["Hyper Text Markup Language", "High Tech Modern Language", "Home Tool Markup Language", "Hyperlinks Text Making Language"],
                answer: 0,
                explanation: "HTML adalah HyperText Markup Language, bahasa markup untuk membuat halaman web.",
                difficulty: "mudah"
            },
            {
                question: "Perangkat input pada komputer adalah?",
                options: ["Monitor", "Printer", "Keyboard", "Speaker"],
                answer: 2,
                explanation: "Keyboard adalah perangkat input yang digunakan untuk memasukkan data ke komputer.",
                difficulty: "mudah"
            }
        ];

        // State variables
        let currentQuestions = [];
        let currentQuestionIndex = 0;
        let score = 0;
        let xp = 0;
        let correctCount = 0;
        let wrongCount = 0;
        let answered = false;

        // Battle variables
        let battleTeams = [];
        let currentTeamIndex = 0;
        let battleMode = 'accuracy';
        let battleQuestionCount = 10;
        let battleTimer = 0;
        let battleTimerInterval = null;
        let battleAnswered = false;
        let questionTimeLimit = 10; // DIUBAH DARI 5 MENJADI 10
        let questionTimer = 0;
        let questionTimerInterval = null;

        // Config untuk editable features
        const defaultConfig = {
            game_title: "üíª Quiz Informatika SMP",
            welcome_message: "Asah Pengetahuan Informatikamu dengan Cara yang Menyenangkan!",
            start_button_text: "Mulai Quiz",
            leaderboard_button_text: "üèÜ Leaderboard",
            background_color: "#667eea",
            card_background: "#ffffff",
            text_color: "#2d3748",
            primary_button_color: "#f093fb",
            secondary_button_color: "#a8edea",
            font_family: "Poppins",
            font_size: 16
        };

        let config = { ...defaultConfig };

        // Fungsi untuk update config
        async function onConfigChange(newConfig) {
            config = { ...newConfig };
            
            const customFont = config.font_family || defaultConfig.font_family;
            const baseFontStack = "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif";
            const baseSize = config.font_size || defaultConfig.font_size;
            
            document.body.style.fontFamily = `${customFont}, ${baseFontStack}`;
            document.body.style.fontSize = `${baseSize}px`;
            
            document.getElementById('gameTitle').textContent = config.game_title || defaultConfig.game_title;
            document.getElementById('welcomeMessage').textContent = config.welcome_message || defaultConfig.welcome_message;
            document.getElementById('leaderboardBtn').textContent = config.leaderboard_button_text || defaultConfig.leaderboard_button_text;
            
            document.body.style.background = `linear-gradient(135deg, ${config.background_color || defaultConfig.background_color} 0%, ${config.secondary_button_color || defaultConfig.secondary_button_color} 100%)`;
            
            const cards = document.querySelectorAll('.card');
            cards.forEach(card => {
                card.style.backgroundColor = config.card_background || defaultConfig.card_background;
            });
            
            const headings = document.querySelectorAll('h1, h2, h3, h4, .question-text');
            headings.forEach(heading => {
                heading.style.color = config.text_color || defaultConfig.text_color;
                heading.style.fontSize = `${baseSize * 1.5}px`;
            });
            
            const primaryBtns = document.querySelectorAll('.btn:not(.btn-secondary)');
            primaryBtns.forEach(btn => {
                btn.style.background = `linear-gradient(135deg, ${config.primary_button_color || defaultConfig.primary_button_color} 0%, #f5576c 100%)`;
            });
            
            const secondaryBtns = document.querySelectorAll('.btn-secondary');
            secondaryBtns.forEach(btn => {
                btn.style.background = `linear-gradient(135deg, ${config.secondary_button_color || defaultConfig.secondary_button_color} 0%, #fed6e3 100%)`;
            });
        }

        // Initialize Element SDK
        if (window.elementSdk) {
            window.elementSdk.init({
                defaultConfig: defaultConfig,
                onConfigChange: onConfigChange,
                mapToCapabilities: (config) => ({
                    recolorables: [
                        {
                            get: () => config.background_color || defaultConfig.background_color,
                            set: (value) => {
                                config.background_color = value;
                                window.elementSdk.setConfig({ background_color: value });
                            }
                        },
                        {
                            get: () => config.card_background || defaultConfig.card_background,
                            set: (value) => {
                                config.card_background = value;
                                window.elementSdk.setConfig({ card_background: value });
                            }
                        },
                        {
                            get: () => config.text_color || defaultConfig.text_color,
                            set: (value) => {
                                config.text_color = value;
                                window.elementSdk.setConfig({ text_color: value });
                            }
                        },
                        {
                            get: () => config.primary_button_color || defaultConfig.primary_button_color,
                            set: (value) => {
                                config.primary_button_color = value;
                                window.elementSdk.setConfig({ primary_button_color: value });
                            }
                        },
                        {
                            get: () => config.secondary_button_color || defaultConfig.secondary_button_color,
                            set: (value) => {
                                config.secondary_button_color = value;
                                window.elementSdk.setConfig({ secondary_button_color: value });
                            }
                        }
                    ],
                    borderables: [],
                    fontEditable: {
                        get: () => config.font_family || defaultConfig.font_family,
                        set: (value) => {
                            config.font_family = value;
                            window.elementSdk.setConfig({ font_family: value });
                        }
                    },
                    fontSizeable: {
                        get: () => config.font_size || defaultConfig.font_size,
                        set: (value) => {
                            config.font_size = value;
                            window.elementSdk.setConfig({ font_size: value });
                        }
                    }
                }),
                mapToEditPanelValues: (config) => new Map([
                    ["game_title", config.game_title || defaultConfig.game_title],
                    ["welcome_message", config.welcome_message || defaultConfig.welcome_message],
                    ["start_button_text", config.start_button_text || defaultConfig.start_button_text],
                    ["leaderboard_button_text", config.leaderboard_button_text || defaultConfig.leaderboard_button_text]
                ])
            });
        }

        // Utility Functions
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        function showSection(sectionId) {
            const sections = ['menuUtama', 'quizSection', 'resultSection', 'leaderboardSection', 'adminPanel', 'battleSetup', 'battleQuizSection', 'battleResultSection'];
            sections.forEach(id => {
                document.getElementById(id).classList.add('hidden');
            });
            document.getElementById(sectionId).classList.remove('hidden');
        }

        function saveToLeaderboard(score, xp) {
            let leaderboard = JSON.parse(localStorage.getItem('leaderboard')) || [];
            
            const entry = {
                score: score,
                xp: xp,
                date: new Date().toLocaleDateString('id-ID'),
                timestamp: Date.now()
            };
            
            leaderboard.push(entry);
            leaderboard.sort((a, b) => b.score - a.score);
            leaderboard = leaderboard.slice(0, 10);
            
            localStorage.setItem('leaderboard', JSON.stringify(leaderboard));
        }

        function showNotification(message, isSuccess) {
            const notification = document.createElement('div');
            notification.style.cssText = `position: fixed; top: 20px; right: 20px; background: ${isSuccess ? '#c6f6d5' : '#fed7d7'}; color: ${isSuccess ? '#22543d' : '#742a2a'}; padding: 15px 25px; border-radius: 10px; font-weight: 600; z-index: 10000; box-shadow: 0 4px 15px rgba(0,0,0,0.2); animation: fadeInDown 0.3s ease-out;`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'fadeInUp 0.3s ease-out reverse';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // Quiz Functions
        function startQuiz() {
            currentQuestions = shuffleArray(questionsData).slice(0, 10);
            currentQuestionIndex = 0;
            score = 0;
            xp = 0;
            correctCount = 0;
            wrongCount = 0;
            
            showSection('quizSection');
            loadQuestion();
        }

        function loadQuestion() {
            answered = false;
            const question = currentQuestions[currentQuestionIndex];
            
            document.getElementById('questionNumber').textContent = currentQuestionIndex + 1;
            document.getElementById('totalQuestions').textContent = currentQuestions.length;
            document.getElementById('currentScore').textContent = score;
            document.getElementById('currentXP').textContent = xp;
            
            const progress = ((currentQuestionIndex + 1) / currentQuestions.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            
            document.getElementById('questionText').textContent = question.question;
            document.getElementById('explanationBox').classList.add('hidden');
            document.getElementById('nextBtn').style.display = 'none';
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.textContent = String.fromCharCode(65 + index) + '. ' + option;
                btn.onclick = () => selectAnswer(index);
                optionsContainer.appendChild(btn);
            });
        }

        function selectAnswer(selectedIndex) {
            if (answered) return;
            
            answered = true;
            const question = currentQuestions[currentQuestionIndex];
            const optionBtns = document.querySelectorAll('.option-btn');
            
            optionBtns.forEach(btn => btn.disabled = true);
            
            if (selectedIndex === question.answer) {
                optionBtns[selectedIndex].classList.add('correct');
                correctCount++;
                
                const points = question.difficulty === 'mudah' ? 10 : 20;
                const xpPoints = question.difficulty === 'mudah' ? 50 : 100;
                
                score += points;
                xp += xpPoints;
                
                document.getElementById('currentScore').textContent = score;
                document.getElementById('currentXP').textContent = xp;
            } else {
                optionBtns[selectedIndex].classList.add('wrong');
                optionBtns[question.answer].classList.add('correct');
                wrongCount++;
            }
            
            document.getElementById('explanationText').textContent = question.explanation;
            document.getElementById('explanationBox').classList.remove('hidden');
            document.getElementById('nextBtn').style.display = 'block';
        }

        function nextQuestion() {
            currentQuestionIndex++;
            
            if (currentQuestionIndex < currentQuestions.length) {
                loadQuestion();
            } else {
                showResults();
            }
        }

        function showResults() {
            saveToLeaderboard(score, xp);
            
            document.getElementById('finalScore').textContent = score;
            document.getElementById('finalXP').textContent = xp;
            document.getElementById('correctAnswers').textContent = correctCount;
            document.getElementById('wrongAnswers').textContent = wrongCount;
            
            const badgesContainer = document.getElementById('badgesContainer');
            badgesContainer.innerHTML = '';
            
            const badges = [];
            if (score >= 160) badges.push('üèÜ Master Informatika');
            if (score >= 120) badges.push('‚≠ê Ahli Komputer');
            if (score >= 80) badges.push('üíª Developer Muda');
            if (correctCount === currentQuestions.length) badges.push('üíØ Sempurna');
            if (xp >= 800) badges.push('üöÄ XP Master');
            if (badges.length === 0) badges.push('üìö Terus Belajar');
            
            badges.forEach(badge => {
                const badgeEl = document.createElement('div');
                badgeEl.className = 'badge';
                badgeEl.textContent = badge;
                badgesContainer.appendChild(badgeEl);
            });
            
            showSection('resultSection');
        }

        function retryQuiz() {
            startQuiz();
        }

        function backToMenu() {
            if (battleTimerInterval) clearInterval(battleTimerInterval);
            if (questionTimerInterval) clearInterval(questionTimerInterval);
            showSection('menuUtama');
        }

        // Leaderboard Functions
        function showLeaderboard() {
            const leaderboard = JSON.parse(localStorage.getItem('leaderboard')) || [];
            const leaderboardList = document.getElementById('leaderboardList');
            
            if (leaderboard.length === 0) {
                leaderboardList.innerHTML = '<p style="text-align: center; color: #718096; padding: 40px;">Belum ada data. Mulai bermain untuk masuk leaderboard!</p>';
            } else {
                leaderboardList.innerHTML = '';
                
                leaderboard.forEach((entry, index) => {
                    const item = document.createElement('div');
                    item.className = 'leaderboard-item';
                    
                    item.innerHTML = `
                        <div class="leaderboard-rank">#${index + 1}</div>
                        <div class="leaderboard-info">
                            <div style="font-weight: 600; color: #2d3748;">Quiz Informatika</div>
                            <div style="font-size: 0.9rem; color: #718096;">${entry.date} ‚Ä¢ ${entry.xp} XP</div>
                        </div>
                        <div class="leaderboard-score">${entry.score}</div>
                    `;
                    
                    leaderboardList.appendChild(item);
                });
            }
            
            showSection('leaderboardSection');
        }

        // Battle Functions
        function showBattleSetup() {
            battleTeams = [];
            updateTeamsList();
            showSection('battleSetup');
        }

        function addTeam() {
            const teamNameInput = document.getElementById('teamNameInput');
            const teamName = teamNameInput.value.trim();
            
            if (!teamName) {
                showNotification('Masukkan nama tim terlebih dahulu!', false);
                return;
            }
            
            if (battleTeams.some(team => team.name.toLowerCase() === teamName.toLowerCase())) {
                showNotification('Nama tim sudah ada!', false);
                return;
            }
            
            battleTeams.push({
                name: teamName,
                score: 0,
                correctCount: 0,
                wrongCount: 0,
                totalTime: 0,
                questions: []
            });
            
            teamNameInput.value = '';
            updateTeamsList();
            showNotification(`Tim "${teamName}" berhasil ditambahkan!`, true);
        }

        function updateTeamsList() {
            const teamsList = document.getElementById('teamsList');
            
            if (battleTeams.length === 0) {
                teamsList.innerHTML = '<p style="text-align: center; color: #718096; padding: 20px;">Belum ada tim terdaftar</p>';
                return;
            }
            
            let html = '';
            battleTeams.forEach((team, index) => {
                html += `
                    <div style="display: flex; justify-content: space-between; align-items: center; background: white; padding: 15px; border-radius: 10px; margin-bottom: 10px; border-left: 4px solid ${getTeamColor(index)};">
                        <div>
                            <strong style="color: #2d3748; font-size: 1.1rem;">${team.name}</strong>
                            <div style="color: #718096; font-size: 0.85rem; margin-top: 4px;">Tim ${index + 1}</div>
                        </div>
                        <button onclick="removeTeam(${index})" style="background: #fc8181; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-weight: 600;">üóëÔ∏è Hapus</button>
                    </div>
                `;
            });
            
            teamsList.innerHTML = html;
        }

        function removeTeam(index) {
            const teamName = battleTeams[index].name;
            battleTeams.splice(index, 1);
            updateTeamsList();
            showNotification(`Tim "${teamName}" telah dihapus`, true);
        }

        function getTeamColor(index) {
            const colors = ['#667eea', '#f093fb', '#4fd1c5', '#fbd38d', '#fc8181', '#9f7aea'];
            return colors[index % colors.length];
        }

        function startBattle() {
            if (battleTeams.length < 2) {
                showNotification('Minimal 2 tim untuk memulai battle!', false);
                return;
            }
            
            battleMode = document.getElementById('battleMode').value;
            battleQuestionCount = parseInt(document.getElementById('battleQuestionCount').value);
            
            battleTeams.forEach(team => {
                team.score = 0;
                team.correctCount = 0;
                team.wrongCount = 0;
                team.totalTime = 0;
                team.questions = shuffleArray(questionsData).slice(0, battleQuestionCount);
            });
            
            currentTeamIndex = 0;
            startTeamBattle();
        }

        function startTeamBattle() {
            const team = battleTeams[currentTeamIndex];
            currentQuestions = team.questions;
            currentQuestionIndex = 0;
            battleTimer = 0;
            
            if (battleTimerInterval) clearInterval(battleTimerInterval);
            battleTimerInterval = setInterval(() => {
                battleTimer++;
                document.getElementById('battleTimer').textContent = battleTimer;
            }, 1000);
            
            showSection('battleQuizSection');
            loadBattleQuestion();
        }

        function loadBattleQuestion() {
            battleAnswered = false;
            const team = battleTeams[currentTeamIndex];
            const question = currentQuestions[currentQuestionIndex];
            
            document.getElementById('currentTeamName').textContent = team.name;
            document.getElementById('battleQuestionNumber').textContent = currentQuestionIndex + 1;
            document.getElementById('battleTotalQuestions').textContent = currentQuestions.length;
            document.getElementById('battleScore').textContent = team.score;
            document.getElementById('battleTimer').textContent = battleTimer;
            
            const progress = ((currentQuestionIndex + 1) / currentQuestions.length) * 100;
            document.getElementById('battleProgressBar').style.width = progress + '%';
            
            document.getElementById('battleQuestionText').textContent = question.question;
            document.getElementById('battleExplanationBox').classList.add('hidden');
            document.getElementById('battleNextBtn').style.display = 'none';
            
            const optionsContainer = document.getElementById('battleOptionsContainer');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.textContent = String.fromCharCode(65 + index) + '. ' + option;
                btn.onclick = () => selectBattleAnswer(index);
                optionsContainer.appendChild(btn);
            });
            
            questionTimer = questionTimeLimit; // SEKARANG 10 DETIK
            document.getElementById('questionTimerText').textContent = questionTimer;
            document.getElementById('questionTimerDisplay').style.background = 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)';
            
            if (questionTimerInterval) clearInterval(questionTimerInterval);
            
            questionTimerInterval = setInterval(() => {
                questionTimer--;
                document.getElementById('questionTimerText').textContent = questionTimer;
                
                if (questionTimer <= 3) {
                    document.getElementById('questionTimerDisplay').style.background = 'linear-gradient(135deg, #fc466b 0%, #3f5efb 100%)';
                }
                
                if (questionTimer <= 0) {
                    clearInterval(questionTimerInterval);
                    if (!battleAnswered) {
                        timeUpBattleQuestion();
                    }
                }
            }, 1000);
        }

        function selectBattleAnswer(selectedIndex) {
            if (battleAnswered) return;
            
            battleAnswered = true;
            
            if (questionTimerInterval) {
                clearInterval(questionTimerInterval);
            }
            
            const team = battleTeams[currentTeamIndex];
            const question = currentQuestions[currentQuestionIndex];
            const optionBtns = document.querySelectorAll('#battleOptionsContainer .option-btn');
            
            optionBtns.forEach(btn => btn.disabled = true);
            
            if (selectedIndex === question.answer) {
                optionBtns[selectedIndex].classList.add('correct');
                team.correctCount++;
                
                const points = question.difficulty === 'mudah' ? 10 : 20;
                team.score += points;
                
                document.getElementById('battleScore').textContent = team.score;
            } else {
                optionBtns[selectedIndex].classList.add('wrong');
                optionBtns[question.answer].classList.add('correct');
                team.wrongCount++;
            }
            
            document.getElementById('battleExplanationText').textContent = question.explanation;
            document.getElementById('battleExplanationBox').classList.remove('hidden');
            document.getElementById('battleNextBtn').style.display = 'block';
        }
        
        function timeUpBattleQuestion() {
            if (battleAnswered) return;
            
            battleAnswered = true;
            
            const team = battleTeams[currentTeamIndex];
            const question = currentQuestions[currentQuestionIndex];
            const optionBtns = document.querySelectorAll('#battleOptionsContainer .option-btn');
            
            optionBtns.forEach(btn => btn.disabled = true);
            
            optionBtns[question.answer].classList.add('correct');
            team.wrongCount++;
            
            const notification = document.createElement('div');
            notification.style.cssText = 'position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: linear-gradient(135deg, #fc466b 0%, #3f5efb 100%); color: white; padding: 30px 50px; border-radius: 20px; font-size: 2rem; font-weight: 700; z-index: 10000; box-shadow: 0 10px 40px rgba(0,0,0,0.4); animation: fadeInUp 0.3s ease-out;';
            notification.textContent = '‚è∞ Waktu Habis!';
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 2000);
            
            document.getElementById('battleExplanationText').textContent = question.explanation + ' (Waktu habis, tidak ada jawaban yang dipilih)';
            document.getElementById('battleExplanationBox').classList.remove('hidden');
            document.getElementById('battleNextBtn').style.display = 'block';
        }

        function nextBattleQuestion() {
            currentQuestionIndex++;
            
            if (currentQuestionIndex < currentQuestions.length) {
                loadBattleQuestion();
            } else {
                finishTeamBattle();
            }
        }

        function finishTeamBattle() {
            if (battleTimerInterval) clearInterval(battleTimerInterval);
            if (questionTimerInterval) clearInterval(questionTimerInterval);
            
            battleTeams[currentTeamIndex].totalTime = battleTimer;
            
            currentTeamIndex++;
            
            if (currentTeamIndex < battleTeams.length) {
                showTeamTransition();
            } else {
                showBattleResults();
            }
        }

        function showTeamTransition() {
            const nextTeam = battleTeams[currentTeamIndex];
            
            const transitionDiv = document.createElement('div');
            transitionDiv.id = 'teamTransition';
            transitionDiv.style.cssText = 'position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.9); z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center;';
            
            const contentDiv = document.createElement('div');
            contentDiv.style.cssText = 'text-align: center; color: white;';
            
            contentDiv.innerHTML = `
                <div style="font-size: 4rem; margin-bottom: 20px;">‚öîÔ∏è</div>
                <h2 style="font-size: 2.5rem; margin-bottom: 20px; color: white;">Giliran Selanjutnya</h2>
                <div style="font-size: 2rem; color: ${getTeamColor(currentTeamIndex)}; font-weight: 700; margin-bottom: 30px;">${nextTeam.name}</div>
                <p style="font-size: 1.2rem; margin-bottom: 40px; opacity: 0.9;">Siapkan diri untuk ${battleQuestionCount} soal!</p>
            `;
            
            const startButton = document.createElement('button');
            startButton.id = 'startNextTeamBtn';
            startButton.style.cssText = 'background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; border: none; padding: 18px 40px; border-radius: 30px; font-size: 1.2rem; font-weight: 600; cursor: pointer; box-shadow: 0 4px 15px rgba(0,0,0,0.3);';
            startButton.textContent = 'üöÄ Mulai Sekarang';
            startButton.onclick = function() {
                const transition = document.getElementById('teamTransition');
                if (transition) {
                    transition.remove();
                }
                startTeamBattle();
            };
            
            contentDiv.appendChild(startButton);
            transitionDiv.appendChild(contentDiv);
            document.body.appendChild(transitionDiv);
        }

        function showBattleResults() {
            let sortedTeams = [...battleTeams];
            
            if (battleMode === 'speed') {
                sortedTeams.sort((a, b) => {
                    if (a.score === b.score) {
                        return a.totalTime - b.totalTime;
                    }
                    return b.score - a.score;
                });
            } else {
                sortedTeams.sort((a, b) => b.score - a.score);
            }
            
            const resultsContainer = document.getElementById('battleResultsContainer');
            let html = '';
            
            sortedTeams.forEach((team, index) => {
                const teamColor = getTeamColor(battleTeams.indexOf(team));
                const medal = index === 0 ? 'üèÜ' : index === 1 ? 'ü•à' : index === 2 ? 'ü•â' : `#${index + 1}`;
                
                html += `
                    <div style="background: linear-gradient(135deg, ${teamColor}20 0%, ${teamColor}10 100%); padding: 25px; border-radius: 15px; margin-bottom: 20px; border-left: 5px solid ${teamColor};">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; flex-wrap: wrap; gap: 15px;">
                            <div style="display: flex; align-items: center; gap: 15px;">
                                <div style="font-size: 2.5rem;">${medal}</div>
                                <div>
                                    <h3 style="color: #2d3748; margin-bottom: 5px;">${team.name}</h3>
                                    <div style="color: #718096; font-size: 0.9rem;">${battleMode === 'speed' ? '‚ö° Speed Mode' : 'üéØ Accuracy Mode'}</div>
                                </div>
                            </div>
                            <div style="text-align: right;">
                                <div style="font-size: 2.5rem; font-weight: 700; color: ${teamColor};">${team.score}</div>
                                <div style="color: #718096; font-size: 0.9rem;">Skor Total</div>
                            </div>
                        </div>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 15px; margin-top: 15px;">
                            <div style="background: white; padding: 12px; border-radius: 8px; text-align: center;">
                                <div style="font-size: 1.5rem; font-weight: 700; color: #48bb78;">${team.correctCount}</div>
                                <div style="font-size: 0.85rem; color: #718096;">Benar</div>
                            </div>
                            <div style="background: white; padding: 12px; border-radius: 8px; text-align: center;">
                                <div style="font-size: 1.5rem; font-weight: 700; color: #f56565;">${team.wrongCount}</div>
                                <div style="font-size: 0.85rem; color: #718096;">Salah</div>
                            </div>
                            <div style="background: white; padding: 12px; border-radius: 8px; text-align: center;">
                                <div style="font-size: 1.5rem; font-weight: 700; color: #667eea;">${team.totalTime}s</div>
                                <div style="font-size: 0.85rem; color: #718096;">Waktu</div>
                            </div>
                            <div style="background: white; padding: 12px; border-radius: 8px; text-align: center;">
                                <div style="font-size: 1.5rem; font-weight: 700; color: #9f7aea;">${Math.round((team.correctCount / battleQuestionCount) * 100)}%</div>
                                <div style="font-size: 0.85rem; color: #718096;">Akurasi</div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            resultsContainer.innerHTML = html;
            
            const winner = sortedTeams[0];
            const winnerColor = getTeamColor(battleTeams.indexOf(winner));
            
            document.getElementById('winnerAnnouncement').innerHTML = `
                <div style="animation: fadeInUp 0.6s ease-out;">
                    <div style="font-size: 5rem; margin-bottom: 20px;">üèÜ</div>
                    <h2 style="color: #2d3748; font-size: 2rem; margin-bottom: 10px;">Pemenang Battle</h2>
                    <div style="font-size: 2.5rem; font-weight: 700; margin-bottom: 15px; background: linear-gradient(135deg, ${winnerColor} 0%, ${winnerColor}80 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">${winner.name}</div>
                    <div style="background: ${winnerColor}20; padding: 15px 30px; border-radius: 50px; display: inline-block;">
                        <span style="font-size: 1.5rem; font-weight: 700; color: ${winnerColor};">${winner.score} Poin</span>
                        ${battleMode === 'speed' ? ` ‚Ä¢ ${winner.totalTime}s` : ''}
                    </div>
                </div>
            `;
            
            showSection('battleResultSection');
        }

        // Admin Panel Functions
        function showAdminPanel() {
            showSection('adminPanel');
            document.getElementById('questionsList').innerHTML = '';
        }

        function showUploadStatus(message, isSuccess) {
            const statusDiv = document.getElementById('uploadStatus');
            statusDiv.style.display = 'block';
            statusDiv.style.background = isSuccess ? '#c6f6d5' : '#fed7d7';
            statusDiv.style.color = isSuccess ? '#22543d' : '#742a2a';
            statusDiv.style.border = isSuccess ? '2px solid #48bb78' : '2px solid #f56565';
            statusDiv.innerHTML = message;
            
            setTimeout(() => {
                statusDiv.style.display = 'none';
            }, 5000);
        }

        function importBulkQuestions() {
            const textarea = document.getElementById('bulkQuestionsInput');
            const text = textarea.value.trim();
            
            if (!text) {
                showUploadStatus('‚ùå Silakan paste soal terlebih dahulu!', false);
                return;
            }
            
            showUploadStatus('‚è≥ Sedang memproses soal...', true);
            
            try {
                const questions = parseQuestionsFromText(text);
                
                if (questions.length === 0) {
                    showUploadStatus('‚ùå Tidak ada soal yang berhasil diparse. Pastikan format sesuai!', false);
                    return;
                }
                
                questionsData = [...questionsData, ...questions];
                
                localStorage.setItem('questionsData', JSON.stringify(questionsData));
                
                showUploadStatus(`‚úÖ Berhasil menambahkan ${questions.length} soal Informatika!<br><small>Total soal sekarang: ${questionsData.length}</small>`, true);
                
                textarea.value = '';
                
            } catch (error) {
                showUploadStatus('‚ùå Terjadi kesalahan saat memproses soal: ' + error.message, false);
            }
        }

        function parseQuestionsFromText(text) {
            const questions = [];
            const questionBlocks = text.split('---').filter(block => block.trim() !== '');
            
            questionBlocks.forEach(block => {
                try {
                    const lines = block.split('\n').map(line => line.trim()).filter(line => line !== '');
                    
                    let questionText = '';
                    let options = [];
                    let answer = -1;
                    let explanation = '';
                    let difficulty = 'mudah';
                    
                    for (let line of lines) {
                        if (line.startsWith('Pertanyaan:')) {
                            questionText = line.replace('Pertanyaan:', '').trim();
                        } else if (line.match(/^[A-D]\./)) {
                            options.push(line.substring(3).trim());
                        } else if (line.startsWith('Jawaban:')) {
                            const answerLetter = line.replace('Jawaban:', '').trim().toUpperCase();
                            answer = answerLetter.charCodeAt(0) - 65;
                        } else if (line.startsWith('Penjelasan:')) {
                            explanation = line.replace('Penjelasan:', '').trim();
                        } else if (line.startsWith('Tingkat:')) {
                            difficulty = line.replace('Tingkat:', '').trim().toLowerCase();
                        }
                    }
                    
                    if (questionText && options.length === 4 && answer >= 0 && answer <= 3 && explanation) {
                        questions.push({
                            question: questionText,
                            options: options,
                            answer: answer,
                            explanation: explanation,
                            difficulty: difficulty === 'sedang' ? 'sedang' : 'mudah'
                        });
                    }
                } catch (error) {
                    console.error('Error parsing question block:', error);
                }
            });
            
            return questions;
        }

        function viewQuestions() {
            const questionsList = document.getElementById('questionsList');
            
            if (questionsData.length === 0) {
                questionsList.innerHTML = '<p style="text-align: center; color: #718096; padding: 20px;">Belum ada soal.</p>';
                return;
            }
            
            let html = `<h4 style="color: #2d3748; margin-bottom: 15px;">üìã Daftar Soal Informatika (${questionsData.length} soal)</h4>`;
            
            questionsData.forEach((q, index) => {
                html += `
                    <div style="background: white; padding: 15px; border-radius: 10px; margin-bottom: 15px; border-left: 4px solid ${q.difficulty === 'mudah' ? '#48bb78' : '#ed8936'};">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px;">
                            <strong style="color: #2d3748;">${index + 1}. ${q.question}</strong>
                            <span style="background: ${q.difficulty === 'mudah' ? '#c6f6d5' : '#fbd38d'}; color: #2d3748; padding: 4px 12px; border-radius: 20px; font-size: 0.85rem; font-weight: 600; white-space: nowrap; margin-left: 10px;">${q.difficulty.toUpperCase()}</span>
                        </div>
                        <div style="color: #4a5568; font-size: 0.9rem; margin-left: 20px;">
                            ${q.options.map((opt, i) => `<div style="margin: 5px 0;">${String.fromCharCode(65 + i)}. ${opt} ${i === q.answer ? '‚úì' : ''}</div>`).join('')}
                        </div>
                        <div style="margin-top: 10px; padding: 10px; background: #f7fafc; border-radius: 6px; font-size: 0.85rem; color: #4a5568;">
                            <strong>Penjelasan:</strong> ${q.explanation}
                        </div>
                        <button onclick="deleteQuestion(${index})" style="margin-top: 10px; background: #fc8181; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 0.85rem; font-weight: 600;">üóëÔ∏è Hapus</button>
                    </div>
                `;
            });
            
            questionsList.innerHTML = html;
        }

        function deleteQuestion(index) {
            const confirmDiv = document.createElement('div');
            confirmDiv.style.cssText = 'position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px; border-radius: 15px; box-shadow: 0 10px 40px rgba(0,0,0,0.3); z-index: 1000; text-align: center; max-width: 400px;';
            confirmDiv.innerHTML = `
                <h3 style="color: #2d3748; margin-bottom: 15px;">‚ö†Ô∏è Hapus Soal?</h3>
                <p style="color: #4a5568; margin-bottom: 20px;">Apakah Anda yakin ingin menghapus soal ini?</p>
                <div style="display: flex; gap: 10px; justify-content: center;">
                    <button onclick="confirmDeleteQuestion(${index})" style="background: #fc8181; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600;">Ya, Hapus</button>
                    <button onclick="this.closest('div').nextElementSibling.remove(); this.closest('div').remove();" style="background: #cbd5e0; color: #2d3748; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600;">Batal</button>
                </div>
            `;
            
            const backdrop = document.createElement('div');
            backdrop.style.cssText = 'position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 999;';
            backdrop.onclick = () => {
                backdrop.remove();
                confirmDiv.remove();
            };
            
            document.body.appendChild(backdrop);
            document.body.appendChild(confirmDiv);
        }

        function confirmDeleteQuestion(index) {
            questionsData.splice(index, 1);
            
            localStorage.setItem('questionsData', JSON.stringify(questionsData));
            
            document.querySelectorAll('[style*="z-index"]').forEach(el => el.remove());
            
            viewQuestions();
            
            showUploadStatus('‚úÖ Soal berhasil dihapus!', true);
        }

        function resetAllQuestions() {
            const confirmDiv = document.createElement('div');
            confirmDiv.style.cssText = 'position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px; border-radius: 15px; box-shadow: 0 10px 40px rgba(0,0,0,0.3); z-index: 1000; text-align: center; max-width: 400px;';
            confirmDiv.innerHTML = `
                <h3 style="color: #c53030; margin-bottom: 15px;">üö® Reset Semua Soal?</h3>
                <p style="color: #4a5568; margin-bottom: 20px;">Ini akan menghapus SEMUA soal yang telah ditambahkan. Tindakan ini tidak dapat dibatalkan!</p>
                <div style="display: flex; gap: 10px; justify-content: center;">
                    <button onclick="confirmResetAllQuestions()" style="background: #fc8181; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600;">Ya, Reset Semua</button>
                    <button onclick="this.closest('div').nextElementSibling.remove(); this.closest('div').remove();" style="background: #cbd5e0; color: #2d3748; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600;">Batal</button>
                </div>
            `;
            
            const backdrop = document.createElement('div');
            backdrop.style.cssText = 'position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 999;';
            backdrop.onclick = () => {
                backdrop.remove();
                confirmDiv.remove();
            };
            
            document.body.appendChild(backdrop);
            document.body.appendChild(confirmDiv);
        }

        function confirmResetAllQuestions() {
            questionsData = [];
            
            localStorage.removeItem('questionsData');
            
            document.querySelectorAll('[style*="z-index"]').forEach(el => el.remove());
            
            document.getElementById('questionsList').innerHTML = '';
            
            showUploadStatus('‚úÖ Semua soal telah dihapus! Array soal sekarang kosong.', true);
        }

        function loadCustomQuestions() {
            const savedQuestions = JSON.parse(localStorage.getItem('questionsData'));
            
            if (savedQuestions && Array.isArray(savedQuestions) && savedQuestions.length > 0) {
                questionsData = savedQuestions;
            }
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', () => {
            loadCustomQuestions();
            showSection('menuUtama');
        });
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9ac1ea3986c2e77e',t:'MTc2NTQyMzk0OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
